# Clients File Processor

## Introduction

Program created to read flat files in which each line describes a product order. 
The program will generate a list of json objects representing the clients present in the file, 
combining all products from each client in the corresponding order.

The expected layout from the input file is:

| field         | size | type                      |
|---------------|------|---------------------------|
| user id       | 10   | number                    |
| name          | 45   | text                      |
| order id      | 10   | number                    |
| product id    | 10   | number                    |
| product value | 12   | decimal                   |
| purchase date | 8    | number(pattern: yyyyMMdd) |

The output json has the following composition:
```
[ {
  "user_id" : integer,
  "name" : string,
  "orders" : [ {
    "order_id" : integer,
    "total" : number,
    "date" : string,
    "products" : [ {
      "product_id" : integer,
      "value" : number
    } ]
  } ]
} ]
```

## External Libs

**Jackson Databind** provides the mapper to convert all the objects parsed and processed from the input file into the output json file.

**JUnit** provides the test engine, while the **maven surefire plugin** generates the reports from test executions. 

**JaCoCo** generates the test coverage reports.

## Building and Testing

### Testing
To run the tests and generate the coverage report, run from the root directory of the project:
```
./mvnw test
```

The tests results will be available at the surefire-reports folder at the target directory.
The coverage reports generated by jacoco will also be available at the target directory, inside /site/jacoco.

### Building

To build the executable jar of the file processor (including the external dependencies), run:
```
./mvnw package
```

## Running the Application

From the target directory where the jar was built, simply run:
```
java -jar file-processor-0.0.1-SNAPSHOT-jar-with-dependencies.jar "/path/to/input-file/or/directory"
```

The program expects one and only one argument describing:

(I) the path to the input file to be processed, or

(II) a directory containing file(s) to be processed.

Only text files **(.txt)** are accepted by the processor, therefore other file types are ignored.
If the input argument refers to a directory, all subdirectories are read recursively and all text files are processed by the program. 

The generated json file corresponding to each text file processed will have the same path and name of the input file,
adding the suffix "_output" and changing the file extension to json. Example:

```
 path/to/input/file1.txt -> path/to/input/file1_output.json 
```